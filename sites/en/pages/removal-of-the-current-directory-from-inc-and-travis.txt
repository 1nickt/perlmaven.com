=title Removal of the current directory (".") from @INC in Perl 5.26 and Travis-CI
=timestamp 2017-11-29T10:30:01
=indexes Travis-CI, @INC, PERL_USE_UNSAFE_INC
=status show
=author szabgab
=archive 1
=comments_disqus_enable 1

=abstract start

Perl used to have ".", the current directory in <a href="/search/@INC">@INC</a>, the list of directories it uses to load modules from.
due to security concerns in Perl 5.26 it was removed. That means code that relied on "." will break when you upgrade to Perl 5.26.

The Perl delta explains
<a href="https://metacpan.org/pod/release/XSAWYERX/perl-5.26.0/pod/perldelta.pod#Removal-of-the-current-directory-%28%22.%22%29-from-@INC">how to deal with the removal</a> safely and not so safely.

It seems as of 29 November 2017 <a href="https://travis-ci.org/">Travis-CI</a> sets the <hl>PERL_USE_UNSAFE_INC</hl> environment variable to 1 that tells Perl to add "." back to <hl>@INC</hl> restoring the potential security issue.

I think this is a bad idea.

=abstract end

Travis itself might not need to be concerned with the security implications of this setting for their own servers. After all the allow us to run whatever code we want on their servers. This setting, however does not reflect the harsher natural environment your code will run in and thus the setting will hide issues you might have with your code. In other words. Tests might pass on Perl 5.26 on Travis-CI, but not on a Perl 5.26 out in the wild.

IMHO Travis should remove the <hl>PERL_USE_UNSAFE_INC=1</hl> from the Perl environments to make it more similar to real world environments.

In the meantime you can add the following entry to your <hl>.travis.yml</hl> file. That will remove "." from @INC in Perl 5.26 and higher.

<code>
env:
  - PERL_USE_UNSAFE_INC=0
</code>

BTW There are plenty of way to <a href="/how-to-change-inc-to-find-perl-modules-in-non-standard-locations">change @INC to find Perl modules in non-standard locations</a> or in a <a href="/beginner-perl-maven-changing-inc-relative-path">relative directory</a> without compromising the security of your system.

