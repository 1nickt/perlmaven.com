=title Creating bar graphs using Perl GD::Graph
=timestamp 2015-02-01T07:30:01
=indexes GD::Graph
=status draft
=books beginner_book
=author szabgab
=archive 1
=comments_disqus_enable 1

=abstract start

<a href="https://metacpan.org/pod/GD::Graph">GD::Graph</a> makes it easy to create various types of
graphs using Perl. The distribution comes with an extensive set of examples. In this article we are
going to see a bar-graph and how various parameters impact its look.

=abstract end

This code is based on the <a href="https://metacpan.org/release/GDGraph">sample11.pl</a> file included included
in the distribution.

<include file="examples/gdgraph_bars.pl">

After loading the <a href="https://metacpan.org/pod/GD::Graph::Data">GD::Graph::Data</a> module that represents the
raw data, and the <hl>GD::Graph::bars</hl> module that handles the creation of the vertical bar-graphs, we create the data.
The first array reference holds the values of the x-axis, the second array reference holds the corresponding values
of the y-axis.

Then we create a <hl>GD::Graph::bars</hl> object. Set some parameters and call the <hl>plot</hl> method that
draws the image. At the end we call <hl>$graph->gd->png</hl> that exports the image in <b>PNG</b> format.
In this example we save the image in a file, but if this was a web environment we might just return the image.

Running the script will generated the following graph:

<img src="/img/gdgraph/bars_plain.png" alt="just a bar graph created by Perl GD::Graph" />

It is a bit "bulky", but we can clearly see the values on the x-axis we provided in the data.
It is clear that the content of the <hl>title</hl> parameter is at the top of the graph and the values of the
<hl>x_label</hl> and <hl>y_label</hl> parameters were added under the x-axis and next to the y-axis respectively.

Let's see what happens as we enable the rest of the parameters one-by-one.

<h2>y_max_value</h2>

In the previous graph the y-axis ran from 0 to 10. I am not sure why did it run exactly to 10, it is somehow
calculated from the max value that needs to be displayed. (In a simple experiment I changed one of the values to 12
and the y-axis ran up to 25.) In any case, if you are not satisfied with the max y-axis value calculated by the module,
you can supply your own number using th
<a href="https://metacpan.org/pod/GD::Graph#y_max_value-y_min_value">y_max_value</a> parameter.
We set it to 7 and got the following result:

<code lang="perl">
    y_max_value     => 7,
</code>
 
<img src="/img/gdgraph/bars_y_max_value.png" alt="y_max_value set" />

<h2>y_tick_number</h2>

If you look at the y-axis of the previous graphs, you'll see there are 5 numbers above the 0
4 of them with little "ticks" and the 5th is the max-value of the y-axis.

The number of ticks is controlled by the <a href="https://metacpan.org/pod/GD::Graph#y_tick_number">y_tick_number</a>
parameter. It defaults to 5, but for the next graph we set it to be 8 and indeed we now have 8 numbers above the 0
including the max value of the y-axis.

These ticks can make it easier to see how tall each one of the bars is.

<code lang="perl">
    y_tick_number   => 8,
</code>

<img src="/img/gdgraph/bars_y_tick_number.png" alt="y_tick_number set" />

<h2>y_label_skip</h2>

While having many ticks and corresponding y-values can make it easier to read
the grahp, but if we have two many of them then the graph might get ugly or
the numbers might become unreadable. An alternative that you can see employed
in many places is to have many ticks, but show the numbers only at some of them.

The <a href="https://metacpan.org/pod/GD::Graph#x_label_skip-y_label_skip">y_label_skip</a> parameter
controls this behavior. Though the name of the parameter is probably incorrect because the value of
this parameter defines which ticks should have a number as well. <hl>y_label_skip => 2</hl> means
show the number on every second tick, <hl>y_label_skip => 3</hl> means show the number on every 3rd
tick.

<code lang="perl">
    y_label_skip    => 3,
</code>

<img src="/img/gdgraph/bars_y_label_skip.png" alt="y_label_skip set" />

<h2>bars_x_labels_vertical.png</h2>

<code lang="perl">
    bars_x_labels_vertical => 1,
</code>

<img src="/img/gdgraph/bars_x_labels_vertical.png" alt="x_labels_vertical set" />




<h2>transparent</h2>

<img src="/img/gdgraph/bars_all.png" alt="transparent set" />


